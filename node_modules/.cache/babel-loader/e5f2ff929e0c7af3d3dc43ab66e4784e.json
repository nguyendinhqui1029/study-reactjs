{"ast":null,"code":"import _toConsumableArray from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import Input from\"../../component/Input/Input\";import SelectedInput from\"../../component/SelectedInput/SelectedInput\";import Textarea from\"../../component/Textarea/Textarea\";import{Formik,Form,FastField,Field,useFormikContext}from\"formik\";import\"./DeliveryAddress.scss\";import{useDispatch}from\"react-redux\";import{addAddress,addAddressOther}from\"../../actions/cart\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";DeliveryAddress.defaultProps={isSubmitForm:false};function DeliveryAddress(props){var isSubmitForm=props.isSubmitForm;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),cities=_useState2[0],setCities=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),districts=_useState4[0],setDistricts=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),districtsByCity=_useState6[0],setDistrictsByCity=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),districtsByCitySubAddress=_useState8[0],setDistrictsByCitySubAddress=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selectedCity=_useState10[0],setSelectedCity=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),selectedCitySubAddress=_useState12[0],setSelectedCitySubAddress=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isShowOtherAddress=_useState14[0],setShowOtherAddress=_useState14[1];var dispatch=useDispatch();var initialValues={address:{name:\"\",email:\"\",address:\"\",city:\"\",district:\"\",description:\"\"},otherAddress:{nameOther:\"\",emailOther:\"\",addressOther:\"\",cityOther:\"\",districtOther:\"\",descriptionOther:\"\"}};var fetchCities=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var header,urlRequest,response,responseJson,responseJsonMap;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;header={headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\"}};urlRequest=\"/json/cities.json\";_context.next=5;return fetch(urlRequest,header);case 5:response=_context.sent;_context.next=8;return response.json();case 8:responseJson=_context.sent;responseJsonMap=responseJson.map(function(item){return{value:item.id,label:item.label};});setCities(responseJsonMap);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function fetchCities(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchCities();},[]);useEffect(function(){fetchDistricts();},[selectedCity,selectedCitySubAddress]);function fetchDistricts(){return _fetchDistricts.apply(this,arguments);}function _fetchDistricts(){_fetchDistricts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var districtsList,districtsSubAddress,header,urlRequest,response,responseJson,responseJsonMap;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;districtsList=[];districtsSubAddress=[];if(districts.length){_context2.next=19;break;}header={headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\"}};urlRequest=\"/json/districts.json\";_context2.next=8;return fetch(urlRequest,header);case 8:response=_context2.sent;_context2.next=11;return response.json();case 11:responseJson=_context2.sent;responseJsonMap=responseJson.map(function(item){return{districts:item.district.map(function(item){return{value:item.alias,label:item.label};}),idCity:item.idCity};});setDistricts(responseJsonMap);responseJsonMap.forEach(function(district){district.idCity===selectedCity&&districtsList.push.apply(districtsList,_toConsumableArray(district.districts));district.idCity===selectedCitySubAddress&&districtsSubAddress.push.apply(districtsSubAddress,_toConsumableArray(district.districts));});setDistrictsByCity(Object.assign(districtsList));setDistrictsByCitySubAddress(Object.assign(districtsSubAddress));_context2.next=23;break;case 19:districts.forEach(function(district){district.idCity===selectedCity&&districtsList.push.apply(districtsList,_toConsumableArray(district.districts));district.idCity===selectedCitySubAddress&&districtsSubAddress.push.apply(districtsSubAddress,_toConsumableArray(district.districts));});console.log(districtsList);setDistrictsByCity(Object.assign(districtsList));setDistrictsByCitySubAddress(Object.assign(districtsSubAddress));case 23:_context2.next=28;break;case 25:_context2.prev=25;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 28:case\"end\":return _context2.stop();}}},_callee2,null,[[0,25]]);}));return _fetchDistricts.apply(this,arguments);}function changeOtherAddress(event){setShowOtherAddress(event.target.checked);}var AutoSubmit=function AutoSubmit(){var _useFormikContext=useFormikContext(),values=_useFormikContext.values,submitForm=_useFormikContext.submitForm;useEffect(function(){if(isSubmitForm){submitForm();}},[isSubmitForm]);return null;};return/*#__PURE__*/_jsxs(\"div\",{className:\"DeliveryAddress\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"HeaderContainer\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"HeaderContent\",children:\"1. \\u0110\\u1ECAA CH\\u1EC8 THANH TO\\xC1N V\\xC0 GIAO H\\xC0NG\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ContentContainer\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"HeaderContent\",children:\"TH\\xD4NG TIN THANH TO\\xC1N\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ContainerLink\",children:[/*#__PURE__*/_jsx(Link,{to:\"link123\",className:\"RegisterLink\",children:\"\\u0110\\u0103ng k\\xFD t\\xE0i kho\\u1EA3n mua h\\xE0ng\"}),/*#__PURE__*/_jsx(\"span\",{children:\"|\"}),/*#__PURE__*/_jsx(Link,{to:\"link124\",className:\"LoginLink\",children:\"\\u0110\\u0103ng nh\\u1EADp\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"MainInfo\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Mua h\\xE0ng kh\\xF4ng c\\u1EA7n t\\xE0i kho\\u1EA3n\"}),/*#__PURE__*/_jsx(Formik,{initialValues:initialValues.address,onSubmit:function onSubmit(value){dispatch(addAddress(value));},render:function render(){return/*#__PURE__*/_jsxs(Form,{className:\"FormInfo\",children:[/*#__PURE__*/_jsx(FastField,{name:\"name\",component:Input,type:\"text\",placeholder:\"H\\u1ECD v\\xE0 T\\xEAn\"}),/*#__PURE__*/_jsx(FastField,{name:\"email\",component:Input,type:\"text\",placeholder:\"Email\"}),/*#__PURE__*/_jsx(FastField,{name:\"address\",component:Input,type:\"text\",placeholder:\"\\u0110\\u1ECBa ch\\u1EC9\"}),/*#__PURE__*/_jsx(Field,{name:\"city\",component:SelectedInput,dataSource:cities,optionEventChange:setSelectedCity,placeHolder:\"Vui l\\xF2ng ch\\u1ECDn th\\xE0nh ph\\u1ED1\"}),/*#__PURE__*/_jsx(Field,{name:\"district\",component:SelectedInput,dataSource:districtsByCity,disabled:!districtsByCity.length}),/*#__PURE__*/_jsx(FastField,{name:\"description\",component:Textarea,placeholder:\"Ghi ch\\xFA \\u0111\\u01A1n h\\xE0ng\",rows:5}),/*#__PURE__*/_jsx(AutoSubmit,{})]});}})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"HeaderContent\",children:\"TH\\xD4NG TIN GIAO H\\xC0NG\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"SubInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"otherAddress\",placeholder:\"H\\u1ECD v\\xE0 T\\xEAn\",onChange:function onChange(event){return changeOtherAddress(event);}}),/*#__PURE__*/_jsx(\"span\",{children:\"Giao h\\xE0ng \\u0111\\u1ECBa ch\\u1EC9 kh\\xE1c\"})]}),/*#__PURE__*/_jsx(Formik,{initialValues:initialValues.otherAddress,onSubmit:function onSubmit(value){if(!isShowOtherAddress){dispatch(addAddressOther(initialValues.otherAddress));}else{dispatch(addAddressOther(value));}},render:function render(){return/*#__PURE__*/_jsxs(Form,{className:isShowOtherAddress?\"FormInfo\":\"SubForm\",children:[/*#__PURE__*/_jsx(FastField,{name:\"nameOther\",component:Input,type:\"text\",placeholder:\"H\\u1ECD v\\xE0 T\\xEAn\"}),/*#__PURE__*/_jsx(FastField,{name:\"emailOther\",component:Input,type:\"text\",placeholder:\"Email\"}),/*#__PURE__*/_jsx(FastField,{name:\"addressOther\",component:Input,type:\"text\",placeholder:\"\\u0110\\u1ECBa ch\\u1EC9\"}),/*#__PURE__*/_jsx(Field,{name:\"cityOther\",component:SelectedInput,dataSource:cities,placeHolder:\"Vui l\\xF2ng ch\\u1ECDn th\\xE0nh ph\\u1ED1\",optionEventChange:setSelectedCitySubAddress}),/*#__PURE__*/_jsx(Field,{name:\"districtOther\",component:SelectedInput,dataSource:districtsByCitySubAddress}),/*#__PURE__*/_jsx(AutoSubmit,{})]});}})]})]})]});}export default DeliveryAddress;","map":{"version":3,"sources":["C:/Users/qnguyen77/Desktop/reactjs/study-react/src/component/DeliveryAddress/DeliveryAddress.jsx"],"names":["React","useEffect","useState","Link","Input","SelectedInput","Textarea","Formik","Form","FastField","Field","useFormikContext","useDispatch","addAddress","addAddressOther","DeliveryAddress","defaultProps","isSubmitForm","props","cities","setCities","districts","setDistricts","districtsByCity","setDistrictsByCity","districtsByCitySubAddress","setDistrictsByCitySubAddress","selectedCity","setSelectedCity","selectedCitySubAddress","setSelectedCitySubAddress","isShowOtherAddress","setShowOtherAddress","dispatch","initialValues","address","name","email","city","district","description","otherAddress","nameOther","emailOther","addressOther","cityOther","districtOther","descriptionOther","fetchCities","header","headers","Accept","urlRequest","fetch","response","json","responseJson","responseJsonMap","map","item","value","id","label","console","log","fetchDistricts","districtsList","districtsSubAddress","length","alias","idCity","forEach","push","Object","assign","changeOtherAddress","event","target","checked","AutoSubmit","values","submitForm"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Input from \"../../component/Input/Input\";\r\nimport SelectedInput from \"../../component/SelectedInput/SelectedInput\";\r\nimport Textarea from \"../../component/Textarea/Textarea\";\r\nimport { Formik, Form, FastField, Field, useFormikContext } from \"formik\";\r\nimport \"./DeliveryAddress.scss\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { addAddress, addAddressOther } from \"../../actions/cart\";\r\nDeliveryAddress.propTypes = {\r\n  isSubmitForm: PropTypes.bool,\r\n};\r\nDeliveryAddress.defaultProps = {\r\n  isSubmitForm: false,\r\n};\r\n\r\nfunction DeliveryAddress(props) {\r\n  const { isSubmitForm } = props;\r\n  const [cities, setCities] = useState([]);\r\n  const [districts, setDistricts] = useState([]);\r\n  const [districtsByCity, setDistrictsByCity] = useState([]);\r\n  const [districtsByCitySubAddress, setDistrictsByCitySubAddress] = useState(\r\n    []\r\n  );\r\n  const [selectedCity, setSelectedCity] = useState(null);\r\n  const [selectedCitySubAddress, setSelectedCitySubAddress] = useState(null);\r\n  const [isShowOtherAddress, setShowOtherAddress] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const initialValues = {\r\n    address: {\r\n      name: \"\",\r\n      email: \"\",\r\n      address: \"\",\r\n      city: \"\",\r\n      district: \"\",\r\n      description: \"\",\r\n    },\r\n    otherAddress: {\r\n      nameOther: \"\",\r\n      emailOther: \"\",\r\n      addressOther: \"\",\r\n      cityOther: \"\",\r\n      districtOther: \"\",\r\n      descriptionOther: \"\",\r\n    },\r\n  };\r\n\r\n  const fetchCities = async () => {\r\n    try {\r\n      const header = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Accept: \"application/json\",\r\n        },\r\n      };\r\n      const urlRequest = \"/json/cities.json\";\r\n      const response = await fetch(urlRequest, header);\r\n      const responseJson = await response.json();\r\n      const responseJsonMap = responseJson.map((item) => {\r\n        return {\r\n          value: item.id,\r\n          label: item.label,\r\n        };\r\n      });\r\n      setCities(responseJsonMap);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchCities();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchDistricts();\r\n  }, [selectedCity, selectedCitySubAddress]);\r\n\r\n  async function fetchDistricts() {\r\n    try {\r\n      const districtsList = [];\r\n      const districtsSubAddress = [];\r\n      if (!districts.length) {\r\n        const header = {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Accept: \"application/json\",\r\n          },\r\n        };\r\n        const urlRequest = \"/json/districts.json\";\r\n        const response = await fetch(urlRequest, header);\r\n        const responseJson = await response.json();\r\n        const responseJsonMap = responseJson.map((item) => {\r\n          return {\r\n            districts: item.district.map((item) => {\r\n              return { value: item.alias, label: item.label };\r\n            }),\r\n            idCity: item.idCity,\r\n          };\r\n        });\r\n\r\n        setDistricts(responseJsonMap);\r\n        responseJsonMap.forEach((district) => {\r\n          district.idCity === selectedCity &&\r\n            districtsList.push(...district.districts);\r\n          district.idCity === selectedCitySubAddress &&\r\n            districtsSubAddress.push(...district.districts);\r\n        });\r\n\r\n        setDistrictsByCity(Object.assign(districtsList));\r\n        setDistrictsByCitySubAddress(Object.assign(districtsSubAddress));\r\n      } else {\r\n        districts.forEach((district) => {\r\n          district.idCity === selectedCity &&\r\n            districtsList.push(...district.districts);\r\n          district.idCity === selectedCitySubAddress &&\r\n            districtsSubAddress.push(...district.districts);\r\n        });\r\n        console.log(districtsList);\r\n        setDistrictsByCity(Object.assign(districtsList));\r\n        setDistrictsByCitySubAddress(Object.assign(districtsSubAddress));\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  function changeOtherAddress(event) {\r\n    setShowOtherAddress(event.target.checked);\r\n  }\r\n\r\n  const AutoSubmit = () => {\r\n    const { values, submitForm } = useFormikContext();\r\n    useEffect(() => {\r\n      if (isSubmitForm) {\r\n        submitForm();\r\n      }\r\n    }, [isSubmitForm]);\r\n    return null;\r\n  };\r\n  return (\r\n    <div className=\"DeliveryAddress\">\r\n      <div className=\"HeaderContainer\">\r\n        <h3 className=\"HeaderContent\">1. ĐỊA CHỈ THANH TOÁN VÀ GIAO HÀNG</h3>\r\n      </div>\r\n      <div className=\"ContentContainer\">\r\n        <h3 className=\"HeaderContent\">THÔNG TIN THANH TOÁN</h3>\r\n        <div className=\"ContainerLink\">\r\n          <Link to=\"link123\" className=\"RegisterLink\">\r\n            Đăng ký tài khoản mua hàng\r\n          </Link>\r\n          <span>|</span>\r\n          <Link to=\"link124\" className=\"LoginLink\">\r\n            Đăng nhập\r\n          </Link>\r\n        </div>\r\n        <div className=\"MainInfo\">\r\n          <h5>Mua hàng không cần tài khoản</h5>\r\n          <Formik\r\n            initialValues={initialValues.address}\r\n            onSubmit={(value) => {\r\n              dispatch(addAddress(value));\r\n            }}\r\n            render={() => {\r\n              return (\r\n                <Form className=\"FormInfo\">\r\n                  <FastField\r\n                    name=\"name\"\r\n                    component={Input}\r\n                    type=\"text\"\r\n                    placeholder=\"Họ và Tên\"\r\n                  />\r\n                  <FastField\r\n                    name=\"email\"\r\n                    component={Input}\r\n                    type=\"text\"\r\n                    placeholder=\"Email\"\r\n                  />\r\n                  <FastField\r\n                    name=\"address\"\r\n                    component={Input}\r\n                    type=\"text\"\r\n                    placeholder=\"Địa chỉ\"\r\n                  />\r\n                  <Field\r\n                    name=\"city\"\r\n                    component={SelectedInput}\r\n                    dataSource={cities}\r\n                    optionEventChange={setSelectedCity}\r\n                    placeHolder=\"Vui lòng chọn thành phố\"\r\n                  />\r\n                  <Field\r\n                    name=\"district\"\r\n                    component={SelectedInput}\r\n                    dataSource={districtsByCity}\r\n                    disabled={!districtsByCity.length}\r\n                  />\r\n                  <FastField\r\n                    name=\"description\"\r\n                    component={Textarea}\r\n                    placeholder=\"Ghi chú đơn hàng\"\r\n                    rows={5}\r\n                  />\r\n                  <AutoSubmit />\r\n                </Form>\r\n              );\r\n            }}\r\n          />\r\n        </div>\r\n        <h3 className=\"HeaderContent\">THÔNG TIN GIAO HÀNG</h3>\r\n        <div className=\"SubInfo\">\r\n          <span>\r\n            <input\r\n              type=\"checkbox\"\r\n              name=\"otherAddress\"\r\n              placeholder=\"Họ và Tên\"\r\n              onChange={(event) => changeOtherAddress(event)}\r\n            />\r\n            <span>Giao hàng địa chỉ khác</span>\r\n          </span>\r\n\r\n          <Formik\r\n            initialValues={initialValues.otherAddress}\r\n            onSubmit={(value) => {\r\n              if (!isShowOtherAddress) {\r\n                dispatch(addAddressOther(initialValues.otherAddress));\r\n              } else {\r\n                dispatch(addAddressOther(value));\r\n              }\r\n            }}\r\n            render={() => {\r\n              return (\r\n                <Form className={isShowOtherAddress ? \"FormInfo\" : \"SubForm\"}>\r\n                  <FastField\r\n                    name=\"nameOther\"\r\n                    component={Input}\r\n                    type=\"text\"\r\n                    placeholder=\"Họ và Tên\"\r\n                  />\r\n                  <FastField\r\n                    name=\"emailOther\"\r\n                    component={Input}\r\n                    type=\"text\"\r\n                    placeholder=\"Email\"\r\n                  />\r\n                  <FastField\r\n                    name=\"addressOther\"\r\n                    component={Input}\r\n                    type=\"text\"\r\n                    placeholder=\"Địa chỉ\"\r\n                  />\r\n                  <Field\r\n                    name=\"cityOther\"\r\n                    component={SelectedInput}\r\n                    dataSource={cities}\r\n                    placeHolder=\"Vui lòng chọn thành phố\"\r\n                    optionEventChange={setSelectedCitySubAddress}\r\n                  />\r\n                  <Field\r\n                    name=\"districtOther\"\r\n                    component={SelectedInput}\r\n                    dataSource={districtsByCitySubAddress}\r\n                  />\r\n                  <AutoSubmit />\r\n                </Form>\r\n              );\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DeliveryAddress;\r\n"]},"metadata":{},"sourceType":"module"}