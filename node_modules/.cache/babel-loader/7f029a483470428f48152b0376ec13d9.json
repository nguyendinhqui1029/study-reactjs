{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/qnguyen77/Desktop/reactjs/study-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useLocation}from\"react-router\";import NavigateQuickly from\"./../../component/NavigateQuickly/NavigateQuickly\";import Header from\"./../../component/Header/Header\";import CardProduct from\"./../../component/CardProduct/CardProduct\";import Pagination from\"./../../component/Pagination/Pagination\";import{useSelector}from\"react-redux\";import\"./ResultSearch.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ResultSearch(){var ITEM_PECENT_PAGE=20;var _useLocation=useLocation(),_useLocation$state=_useLocation.state;_useLocation$state=_useLocation$state===void 0?{}:_useLocation$state;var _useLocation$state$en=_useLocation$state.enter,enter=_useLocation$state$en===void 0?\"\":_useLocation$state$en,_useLocation$state$fi=_useLocation$state.fillter,fillter=_useLocation$state$fi===void 0?\"\":_useLocation$state$fi;var categories=useSelector(function(category){return category.categories.categories;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),productFilter=_useState2[0],setProductFilter=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),productFilterPagination=_useState4[0],setProductFilterPagination=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),currentPage=_useState8[0],setCurrentPage=_useState8[1];useEffect(function(){setIsLoading(true);var listId=getAllCategorySelected(fillter,categories);var listDataSource=[];setCurrentPage(1);if(fillter===\"ALL\"){getProductList(fillter).then(function(result){if(enter){result.forEach(function(item){if(item.productName.includes(enter)){listDataSource.push(item);}});}else{listDataSource.push.apply(listDataSource,_toConsumableArray(result));}setProductFilter([].concat(listDataSource));setProductFilterPagination(listDataSource.splice(0,ITEM_PECENT_PAGE));setIsLoading(false);});}else{Promise.all(listId.forEach(function(id){return getProductList(id).then(function(item){var arrayFilter=[];item.forEach(function(itemFilter){if(itemFilter.productName.includes(enter)){arrayFilter.push(itemFilter);}});return arrayFilter;});})).then(function(result){result.forEach(function(item){listDataSource.push.apply(listDataSource,_toConsumableArray(item));});setProductFilter([].concat(listDataSource));setProductFilterPagination(listDataSource.splice(0,ITEM_PECENT_PAGE));setIsLoading(false);});}},[enter,fillter,categories]);function getProductListByPagination(pagination){var currentPage=pagination.currentPage;var start=currentPage*ITEM_PECENT_PAGE-ITEM_PECENT_PAGE||0;var end=ITEM_PECENT_PAGE;var listMap=_toConsumableArray(productFilter);setProductFilterPagination(_toConsumableArray(listMap.splice(start,end)));}return/*#__PURE__*/_jsxs(\"div\",{className:\"ResultSearch\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"NavigateQuickly\",children:/*#__PURE__*/_jsx(NavigateQuickly,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"Header\",children:/*#__PURE__*/_jsx(Header,{title:\"S\\u1EA3n ph\\u1EA9m\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"BodySearch\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ProductList\",children:[isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"ContainerLoading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"Loading\"}),/*#__PURE__*/_jsx(\"img\",{className:\"ImgLoading\",src:require(\"../../assets/images/loading.gif\").default,alt:\"loading ...\"})]}),!isLoading&&productFilterPagination.length===0?/*#__PURE__*/_jsx(\"div\",{children:\"Not found record match.\"}):productFilterPagination.map(function(product,index){return/*#__PURE__*/_jsx(CardProduct,{itemProduct:product},index);})]}),productFilterPagination.length!==0&&/*#__PURE__*/_jsx(\"div\",{className:\"Pagination\",children:/*#__PURE__*/_jsx(Pagination,{pageChangeClick:getProductListByPagination,itemPage:ITEM_PECENT_PAGE,totalItem:productFilter.length,currentPage:currentPage})})]})]});}var getAllCategorySelected=function getAllCategorySelected(categoriId,categories){var category=categories.find(function(item){return item.id===categoriId;});var arrayIdCategory=[];if(category){category.subCategory.forEach(function(item){var itemMap=item.subCategory.map(function(itemMap){return itemMap.id;});arrayIdCategory.push.apply(arrayIdCategory,_toConsumableArray(itemMap));});}return arrayIdCategory;};var getProductList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(categoryId){var uri,headers,url,response,responseJson;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uri=\"https://api-json-server-290621.herokuapp.com/api/products\";headers={headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\"}};url=categoryId!==\"ALL\"?\"\".concat(uri,\"?categoryId=\").concat(categoryId):uri;_context.next=5;return fetch(url,headers);case 5:response=_context.sent;_context.next=8;return response.json();case 8:responseJson=_context.sent;return _context.abrupt(\"return\",responseJson);case 10:case\"end\":return _context.stop();}}},_callee);}));return function getProductList(_x){return _ref.apply(this,arguments);};}();export default ResultSearch;","map":{"version":3,"sources":["C:/Users/qnguyen77/Desktop/reactjs/study-react/src/screens/ResultSearch/ResultSearch.jsx"],"names":["React","useState","useEffect","useLocation","NavigateQuickly","Header","CardProduct","Pagination","useSelector","ResultSearch","ITEM_PECENT_PAGE","state","enter","fillter","categories","category","productFilter","setProductFilter","productFilterPagination","setProductFilterPagination","isLoading","setIsLoading","currentPage","setCurrentPage","listId","getAllCategorySelected","listDataSource","getProductList","then","result","forEach","item","productName","includes","push","splice","Promise","all","id","arrayFilter","itemFilter","getProductListByPagination","pagination","start","end","listMap","require","default","length","map","product","index","categoriId","find","arrayIdCategory","subCategory","itemMap","categoryId","uri","headers","Accept","url","fetch","response","json","responseJson"],"mappings":"ypBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,WAAT,KAA4B,cAA5B,CACA,MAAOC,CAAAA,eAAP,KAA4B,mDAA5B,CACA,MAAOC,CAAAA,MAAP,KAAmB,iCAAnB,CACA,MAAOC,CAAAA,WAAP,KAAwB,2CAAxB,CACA,MAAOC,CAAAA,UAAP,KAAuB,yCAAvB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,MAAO,qBAAP,C,wFAEA,QAASC,CAAAA,YAAT,EAAwB,CACtB,GAAMC,CAAAA,gBAAgB,CAAG,EAAzB,CACA,iBAAqDP,WAAW,EAAhE,iCAAQQ,KAAR,gDAA8C,EAA9C,iEAAiBC,KAAjB,CAAiBA,KAAjB,gCAAyB,EAAzB,gEAA6BC,OAA7B,CAA6BA,OAA7B,gCAAuC,EAAvC,uBACA,GAAMC,CAAAA,UAAU,CAAGN,WAAW,CAAC,SAACO,QAAD,QAAcA,CAAAA,QAAQ,CAACD,UAAT,CAAoBA,UAAlC,EAAD,CAA9B,CACA,cAA0Cb,QAAQ,CAAC,EAAD,CAAlD,wCAAOe,aAAP,eAAsBC,gBAAtB,eACA,eAA8DhB,QAAQ,CAAC,EAAD,CAAtE,yCAAOiB,uBAAP,eAAgCC,0BAAhC,eACA,eAAkClB,QAAQ,CAAC,KAAD,CAA1C,yCAAOmB,SAAP,eAAkBC,YAAlB,eACA,eAAsCpB,QAAQ,CAAC,CAAD,CAA9C,yCAAOqB,WAAP,eAAoBC,cAApB,eACArB,SAAS,CAAC,UAAM,CACdmB,YAAY,CAAC,IAAD,CAAZ,CACA,GAAMG,CAAAA,MAAM,CAAGC,sBAAsB,CAACZ,OAAD,CAAUC,UAAV,CAArC,CACA,GAAMY,CAAAA,cAAc,CAAG,EAAvB,CACAH,cAAc,CAAC,CAAD,CAAd,CACA,GAAIV,OAAO,GAAK,KAAhB,CAAuB,CACrBc,cAAc,CAACd,OAAD,CAAd,CAAwBe,IAAxB,CAA6B,SAACC,MAAD,CAAY,CACvC,GAAIjB,KAAJ,CAAW,CACTiB,MAAM,CAACC,OAAP,CAAe,SAACC,IAAD,CAAU,CACvB,GAAIA,IAAI,CAACC,WAAL,CAAiBC,QAAjB,CAA0BrB,KAA1B,CAAJ,CAAsC,CACpCc,cAAc,CAACQ,IAAf,CAAoBH,IAApB,EACD,CACF,CAJD,EAKD,CAND,IAMO,CACLL,cAAc,CAACQ,IAAf,OAAAR,cAAc,oBAASG,MAAT,EAAd,CACD,CAEDZ,gBAAgB,WAAKS,cAAL,EAAhB,CACAP,0BAA0B,CAACO,cAAc,CAACS,MAAf,CAAsB,CAAtB,CAAyBzB,gBAAzB,CAAD,CAA1B,CACAW,YAAY,CAAC,KAAD,CAAZ,CACD,CAdD,EAeD,CAhBD,IAgBO,CACLe,OAAO,CAACC,GAAR,CACEb,MAAM,CAACM,OAAP,CAAe,SAACQ,EAAD,CAAQ,CACrB,MAAOX,CAAAA,cAAc,CAACW,EAAD,CAAd,CAAmBV,IAAnB,CAAwB,SAACG,IAAD,CAAU,CACvC,GAAMQ,CAAAA,WAAW,CAAG,EAApB,CACAR,IAAI,CAACD,OAAL,CAAa,SAACU,UAAD,CAAgB,CAC3B,GAAIA,UAAU,CAACR,WAAX,CAAuBC,QAAvB,CAAgCrB,KAAhC,CAAJ,CAA4C,CAC1C2B,WAAW,CAACL,IAAZ,CAAiBM,UAAjB,EACD,CACF,CAJD,EAKA,MAAOD,CAAAA,WAAP,CACD,CARM,CAAP,CASD,CAVD,CADF,EAYEX,IAZF,CAYO,SAACC,MAAD,CAAY,CACjBA,MAAM,CAACC,OAAP,CAAe,SAACC,IAAD,CAAU,CACvBL,cAAc,CAACQ,IAAf,OAAAR,cAAc,oBAASK,IAAT,EAAd,CACD,CAFD,EAGAd,gBAAgB,WAAKS,cAAL,EAAhB,CACAP,0BAA0B,CAACO,cAAc,CAACS,MAAf,CAAsB,CAAtB,CAAyBzB,gBAAzB,CAAD,CAA1B,CACAW,YAAY,CAAC,KAAD,CAAZ,CACD,CAnBD,EAoBD,CACF,CA3CQ,CA2CN,CAACT,KAAD,CAAQC,OAAR,CAAiBC,UAAjB,CA3CM,CAAT,CA6CA,QAAS2B,CAAAA,0BAAT,CAAoCC,UAApC,CAAgD,CAC9C,GAAQpB,CAAAA,WAAR,CAAwBoB,UAAxB,CAAQpB,WAAR,CACA,GAAMqB,CAAAA,KAAK,CAAGrB,WAAW,CAAGZ,gBAAd,CAAiCA,gBAAjC,EAAqD,CAAnE,CACA,GAAMkC,CAAAA,GAAG,CAAGlC,gBAAZ,CACA,GAAMmC,CAAAA,OAAO,oBAAO7B,aAAP,CAAb,CACAG,0BAA0B,oBAAK0B,OAAO,CAACV,MAAR,CAAeQ,KAAf,CAAsBC,GAAtB,CAAL,EAA1B,CACD,CACD,mBACE,aAAK,SAAS,CAAC,cAAf,wBACE,YAAK,SAAS,CAAC,iBAAf,uBACE,KAAC,eAAD,IADF,EADF,cAIE,YAAK,SAAS,CAAC,QAAf,uBACE,KAAC,MAAD,EAAQ,KAAK,CAAC,oBAAd,EADF,EAJF,cAOE,aAAK,SAAS,CAAC,YAAf,wBACE,aAAK,SAAS,CAAC,aAAf,WACGxB,SAAS,eACR,aAAK,SAAS,CAAC,kBAAf,wBACE,YAAK,SAAS,CAAC,SAAf,EADF,cAEE,YACE,SAAS,CAAC,YADZ,CAEE,GAAG,CAAE0B,OAAO,CAAC,iCAAD,CAAP,CAA2CC,OAFlD,CAGE,GAAG,CAAC,aAHN,EAFF,GAFJ,CAWG,CAAC3B,SAAD,EAAcF,uBAAuB,CAAC8B,MAAxB,GAAmC,CAAjD,cACC,gDADD,CAGC9B,uBAAuB,CAAC+B,GAAxB,CAA4B,SAACC,OAAD,CAAUC,KAAV,CAAoB,CAC9C,mBAAO,KAAC,WAAD,EAAyB,WAAW,CAAED,OAAtC,EAAkBC,KAAlB,CAAP,CACD,CAFD,CAdJ,GADF,CAoBGjC,uBAAuB,CAAC8B,MAAxB,GAAmC,CAAnC,eACC,YAAK,SAAS,CAAC,YAAf,uBACE,KAAC,UAAD,EACE,eAAe,CAAEP,0BADnB,CAEE,QAAQ,CAAE/B,gBAFZ,CAGE,SAAS,CAAEM,aAAa,CAACgC,MAH3B,CAIE,WAAW,CAAE1B,WAJf,EADF,EArBJ,GAPF,GADF,CAyCD,CAED,GAAMG,CAAAA,sBAAsB,CAAG,QAAzBA,CAAAA,sBAAyB,CAAC2B,UAAD,CAAatC,UAAb,CAA4B,CACzD,GAAMC,CAAAA,QAAQ,CAAGD,UAAU,CAACuC,IAAX,CAAgB,SAACtB,IAAD,CAAU,CACzC,MAAOA,CAAAA,IAAI,CAACO,EAAL,GAAYc,UAAnB,CACD,CAFgB,CAAjB,CAGA,GAAME,CAAAA,eAAe,CAAG,EAAxB,CACA,GAAIvC,QAAJ,CAAc,CACZA,QAAQ,CAACwC,WAAT,CAAqBzB,OAArB,CAA6B,SAACC,IAAD,CAAU,CACrC,GAAMyB,CAAAA,OAAO,CAAGzB,IAAI,CAACwB,WAAL,CAAiBN,GAAjB,CAAqB,SAACO,OAAD,CAAa,CAChD,MAAOA,CAAAA,OAAO,CAAClB,EAAf,CACD,CAFe,CAAhB,CAGAgB,eAAe,CAACpB,IAAhB,OAAAoB,eAAe,oBAASE,OAAT,EAAf,CACD,CALD,EAMD,CACD,MAAOF,CAAAA,eAAP,CACD,CAdD,CAgBA,GAAM3B,CAAAA,cAAc,0FAAG,iBAAO8B,UAAP,4JACfC,GADe,CACT,2DADS,CAEfC,OAFe,CAEL,CACdA,OAAO,CAAE,CACP,eAAgB,kBADT,CAEPC,MAAM,CAAE,kBAFD,CADK,CAFK,CAQfC,GARe,CAQTJ,UAAU,GAAK,KAAf,WAA0BC,GAA1B,wBAA4CD,UAA5C,EAA2DC,GARlD,uBASEI,CAAAA,KAAK,CAACD,GAAD,CAAMF,OAAN,CATP,QASfI,QATe,qCAUMA,CAAAA,QAAQ,CAACC,IAAT,EAVN,QAUfC,YAVe,+CAWdA,YAXc,yDAAH,kBAAdtC,CAAAA,cAAc,4CAApB,CAaA,cAAelB,CAAAA,YAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useLocation } from \"react-router\";\r\nimport NavigateQuickly from \"./../../component/NavigateQuickly/NavigateQuickly\";\r\nimport Header from \"./../../component/Header/Header\";\r\nimport CardProduct from \"./../../component/CardProduct/CardProduct\";\r\nimport Pagination from \"./../../component/Pagination/Pagination\";\r\nimport { useSelector } from \"react-redux\";\r\nimport \"./ResultSearch.scss\";\r\n\r\nfunction ResultSearch() {\r\n  const ITEM_PECENT_PAGE = 20;\r\n  const { state: { enter = \"\", fillter = \"\" } = {} } = useLocation();\r\n  const categories = useSelector((category) => category.categories.categories);\r\n  const [productFilter, setProductFilter] = useState([]);\r\n  const [productFilterPagination, setProductFilterPagination] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  useEffect(() => {\r\n    setIsLoading(true);\r\n    const listId = getAllCategorySelected(fillter, categories);\r\n    const listDataSource = [];\r\n    setCurrentPage(1);\r\n    if (fillter === \"ALL\") {\r\n      getProductList(fillter).then((result) => {\r\n        if (enter) {\r\n          result.forEach((item) => {\r\n            if (item.productName.includes(enter)) {\r\n              listDataSource.push(item);\r\n            }\r\n          });\r\n        } else {\r\n          listDataSource.push(...result);\r\n        }\r\n\r\n        setProductFilter([...listDataSource]);\r\n        setProductFilterPagination(listDataSource.splice(0, ITEM_PECENT_PAGE));\r\n        setIsLoading(false);\r\n      });\r\n    } else {\r\n      Promise.all(\r\n        listId.forEach((id) => {\r\n          return getProductList(id).then((item) => {\r\n            const arrayFilter = [];\r\n            item.forEach((itemFilter) => {\r\n              if (itemFilter.productName.includes(enter)) {\r\n                arrayFilter.push(itemFilter);\r\n              }\r\n            });\r\n            return arrayFilter;\r\n          });\r\n        })\r\n      ).then((result) => {\r\n        result.forEach((item) => {\r\n          listDataSource.push(...item);\r\n        });\r\n        setProductFilter([...listDataSource]);\r\n        setProductFilterPagination(listDataSource.splice(0, ITEM_PECENT_PAGE));\r\n        setIsLoading(false);\r\n      });\r\n    }\r\n  }, [enter, fillter, categories]);\r\n\r\n  function getProductListByPagination(pagination) {\r\n    const { currentPage } = pagination;\r\n    const start = currentPage * ITEM_PECENT_PAGE - ITEM_PECENT_PAGE || 0;\r\n    const end = ITEM_PECENT_PAGE;\r\n    const listMap = [...productFilter];\r\n    setProductFilterPagination([...listMap.splice(start, end)]);\r\n  }\r\n  return (\r\n    <div className=\"ResultSearch\">\r\n      <div className=\"NavigateQuickly\">\r\n        <NavigateQuickly />\r\n      </div>\r\n      <div className=\"Header\">\r\n        <Header title=\"Sản phẩm\" />\r\n      </div>\r\n      <div className=\"BodySearch\">\r\n        <div className=\"ProductList\">\r\n          {isLoading && (\r\n            <div className=\"ContainerLoading\">\r\n              <div className=\"Loading\"></div>\r\n              <img\r\n                className=\"ImgLoading\"\r\n                src={require(\"../../assets/images/loading.gif\").default}\r\n                alt=\"loading ...\"\r\n              />\r\n            </div>\r\n          )}\r\n          {!isLoading && productFilterPagination.length === 0 ? (\r\n            <div>Not found record match.</div>\r\n          ) : (\r\n            productFilterPagination.map((product, index) => {\r\n              return <CardProduct key={index} itemProduct={product} />;\r\n            })\r\n          )}\r\n        </div>\r\n        {productFilterPagination.length !== 0 && (\r\n          <div className=\"Pagination\">\r\n            <Pagination\r\n              pageChangeClick={getProductListByPagination}\r\n              itemPage={ITEM_PECENT_PAGE}\r\n              totalItem={productFilter.length}\r\n              currentPage={currentPage}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst getAllCategorySelected = (categoriId, categories) => {\r\n  const category = categories.find((item) => {\r\n    return item.id === categoriId;\r\n  });\r\n  const arrayIdCategory = [];\r\n  if (category) {\r\n    category.subCategory.forEach((item) => {\r\n      const itemMap = item.subCategory.map((itemMap) => {\r\n        return itemMap.id;\r\n      });\r\n      arrayIdCategory.push(...itemMap);\r\n    });\r\n  }\r\n  return arrayIdCategory;\r\n};\r\n\r\nconst getProductList = async (categoryId) => {\r\n  const uri = \"https://api-json-server-290621.herokuapp.com/api/products\";\r\n  const headers = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Accept: \"application/json\",\r\n    },\r\n  };\r\n  const url = categoryId !== \"ALL\" ? `${uri}?categoryId=${categoryId}` : uri;\r\n  const response = await fetch(url, headers);\r\n  const responseJson = await response.json();\r\n  return responseJson;\r\n};\r\nexport default ResultSearch;\r\n"]},"metadata":{},"sourceType":"module"}